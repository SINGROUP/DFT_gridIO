<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>PyDFTFileIO</title>
	<meta name='Generator' content='Zim 0.65'>
	<style type='text/css'>
		a          { text-decoration: none      }
		a:hover    { text-decoration: underline }
		a:active   { text-decoration: underline }
		strike     { color: grey                }
		u          { text-decoration: none;
					 background-color: yellow   }
		tt         { color: #2e3436;            }
		pre        { color: #2e3436;
					 margin-left: 20px          }
		h1         { text-decoration: underline;
					 color: #4e9a06; margin-bottom: 0 }
		h2         { color: #4e9a06; margin-bottom: 0 }
		h3         { color: #4e9a06; margin-bottom: 0 }
		h4         { color: #4e9a06; margin-bottom: 0 }
		h5         { color: #4e9a06; margin-bottom: 0 }
		p          { margin-top: 0              }
		span.zim-tag {
			color: #ce5c00;
		}
		div.zim-object {
			border-style:solid;
			border-width:1px;
		}
		.checked-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB9gKGQ8sMEGsKGkAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAEBUlEQVRIx62V22tdRRTGf7Nn73P2ybntnNOe3NqkPTGgLTVUUZF6QatSLOKTPgqCIqLgQ0H/A1sQQbBYCBb1QfAxiC8tSO1FqHkwJVKtjdTGNraUmObsc9nXmfGh7cGYpM1D5nHWzPetteZb3wg2eB2YqYm4zSadsMtoboiNBH/3TE0awx6j+MRoxoTg/IYRvP19TQrJS0bzhdHGSyKFkLTtjSKwMjyiEz43ynhtP6bdjBCWyFobAf7eT7VhNF/q1FRbjYjmUohlCVPwnB+6FUxMTJipqSmUUhhjEGKd3bMT4ks/Y6oLBK2Yth8hHYtCJXOix7Nf7xLMzc0xOzvLzp078TyPNE3viW3QJPXzhNWbxFFKHCmMhoLn/FHodd48vGfhapdAacXQlkFK5dL6wIUm6fuTZPuvqDQhaMUYYyiVyuQr6rXDexYuAdi3tSv1ZJNs/R/CaszzT+1na88uXFnCEnJVgivBNN8uTJKmHQI/ptOOcXNZzMz9mOqFs90OHpipWcYwlo5P4ebnuOkrvr5wgrH+h3im7y36MzuwRXYZeKha/OhP0EkadFoxQSdGSotedR/+XwMc2XvKdNUFOFqZx6LKZWIiwjgkikNmLp/hm8sH+K1zjFTHXfBYdTi+eJArzXM0GxFxoBDCopLvo/fqEwi1XPkWkGqjFo2TgB1jOYZUKZTS/D1/ncmLh7jon0IbRWoiTi59ymzzJEEQE3cStNZsGxqlfPE57MBbOR8fP3hDGalOO9fq2DlBvmZw8xa2IxACGn6TydlD/O6f5OzSV/zif0cYhLQaEXGkKBbz7Ov/AOlXV1cxgBJRI3fuSTrpTawt18kWIZN1CFuaONI0w0WOXfsI43YIggh/KUSlhqxrMz74AkOZcWBm9QkH+Gw8NDLuITi+m0yzhluSyJzBLcpblUhFxywSRAEtPwQjsKVN30CNh0uvYuOubSHLtN3J0TO1j0pmBNuFbFWRK0gyPRZpktL2I5JQkclKakNlnh54g6ocvevUr/Ai2a7wineEkcJupA3S1Wg0nVZM2E6wbEF5U5G9Q++wI7sfR7h3N8HVNstykBfzH+KJEZwiWD0aIwxCgJ0R1Mu7GXOeJSuK93bZtQIle4D9pUNU5DC5jEsu55AvZakM5NicGyEj8uuz8bUCQgj67QfY671P3vEoeC69gy695U1U7NG7XV0pUwBjDJa1/JJlWWxzHuflzQe5FJ/GsgUVuZ2t8lEkTvfc0aNHb72flBhjVicQQqCUuvM3/M+WDVguWBrMVdDXEGZlBVEUrVCU9d9s5+fnaTQa2PZyPxEIhJaI1EEoZwX4ncynp6fXrmB4eJjR0VFarRbNZnP9P9rt9gohqNVq1Ov1ZbF/AZGev3hLJ2/zAAAAAElFTkSuQmCC)}
		.xchecked-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB9gKGQ8bDYnDxEwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAEK0lEQVRIx9WVS2hTWRjHf/eR3CY1nbxMH2YiZRQS6qO13YlMVxY3SnVcuNIBFezGpSADLoQqLu1sHJCqdCFSXFpw4YOCSH3BtFqttTNamabX3DS5bfO6uffMoglja3RGcDMHzuac7/z/53++//cd+L8P6VuCPQYZ8ADNgBd4J31DcDcQs+GnHByRocEDv0kfBSjAOlYCs11Q+gpwDegS8LMJ+3QIK0ATzEhV8Odnz5bzw8P4dJ25aJQ/WlvJ1df/K7hSLtOcTNI+Pk69rpMTgqIQhCDvh1/VSpw79+gRrRMTmLZNezLJJsPg+a5dmOEwQlFqg1sWG16/Jv7sGWXDwBACFQjC9HcwIMONKkGp4PGAJGEDS0IQmZlhnWnye3c3eiyGo6qr3WHbrJ+dJf7gAXI6zSIr72T7/fgzmT4FHnTBsgrQBfYvTU0km5vxz86iADnAm0rRPTWFt7cXZccOJJcLAGHb2K9ekT93jmwmwwdAAFpjI6Ntbfxw5879ag7l6o1sr5eHHR3IsRgeQK/M4sQE+YEB7JcvEY6zAj45SWFgAPPxYwzHoQxIkQjTPT0kIxE+Noj8sexFn4/xnh58iQTeSpHkHAdrbIzi0BCOrmNPTpK/eJHM3bt8sCyKQCiR4NWePWSiUZw1+ZLXJm4pFKLhzBlCsRh2RUXacVgeGaF47RrL58+zcP8+RrmMkCQinZ1EL1zAjERqmkH+tLYl1G3bCJw4QUjT0IA0MJfLMX/5MqmHD0nZNiUgtGULG/r7ccXjINWuWbnmqsuFu7sb/4EDNLlcBIEioNs2KUAFGmMxmk6dQm1tRZI+3xBqEkiShBQOox05Ql1nJ26gvuIUAWiKQnj/ftStW5Fk+YuF+NldsbBA4cYN9KdPmaso8Fc62ZJtk7l1C2t0FGdxESHE1xE4hkHh6lX0oSHSpRIewC/LrPf7CSgKNpCamkI/fZr8pUuIZBIcpyaBunahPp1mub+fDyMjGKUSChCsq6Nh717q9u2jbnSU0uAgRrFIwTThyhUCqRS+hgZKLS1fJvDm87SNjZGcnsYUAjcQ8vsJ9/Xh7u1FDgRQN20iks3iDA+zZFmYhQLqzZtsj8WY3L0baY2Sf55ICCKpFHUzM2SEQAJCHg+hY8fQDh5EDgRWDoRC1J88SePRo2geD0XAcBy8b98Sv3ePYDZbbf2rFQjLIphMsmDbaEBQVQkePox26BCSz7e6i4bDrDt+nGYhmBscpFAskheC4Js3bPR4qHphFYEnlcI7P4/jdqNpGu8TCe4oCsXr1z//F2ga3+/cSfTJE0qmSVYIsKzaOZDcbjKyzFIiwfvt21kMBLA07YsetzWNd+3tLLW0sH5igvT8PH9Go/z44kX+E4LGjg7GDYOcy4XlOEgLC//5P/5LCFzxOPLmzWyIx+m6fduu7v0NVGqyTSycKksAAAAASUVORK5CYII=)}
		.unchecked-box {list-style-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAANOgAADMQBiN+4gQAAAAd0SU1FB9gKGQ8qAt8h3m8AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAA60lEQVRIx+2VsQqDMBRF70sCLg5OLoKgjk7+lJ/hh+STXBwcnRz8ArMEkrxOFktbaC3tULzTg5e8k5vADXDq70VbobXmvu/hvQczg4heHrJfXxQFuq67blZbMc8zpmlCXddIkgTOuZcBUko45zCOI6y1Nz2xFSEEZFmGOI7fGg4A3nsQEZqmuXOu9jallACAtm3fvmutNaIoAjM/dkBECCF89KCbk4eAb+kEnIAT8EsAM0OIz3hSyrssUvss8t5fg+uIrLXPs0gIgWVZYIyBUurQyYdheO4gz3NUVQVjDNZ1PfSjpWmKsixvehfB9GBZ3NndrgAAAABJRU5ErkJggg==)}
		ul {list-style-image: none}
		/* ul rule needed to reset style for sub-bullets */
	</style>
</head>
<body>

<!-- Wiki content -->

	<h1>PyDFTFileIO</h1>

<br>

<h2>Description</h2>

<br>

<p>
Contains Python modules for efficient reading and writing of file formats containing values on a grid of points used by DFT codes. Modules for reading <b>cube</b> and <b>LOCPOT/CHGCAR</b> files are implemented as well as a module for writing <b>cube</b> files. cube format is used by CP2k and Gaussian, for example, and LOCPOT and CHGCAR formats by VASP.
</p>

<p>
Since the grids used by DFT codes contain a high number of points, the output files have a significant amount of data. High performance of the reading and writing of these files is thus essential. Therefore, these modules are written in Cython (Python with C-extensions) which is a compromise between speed of C and readability of Python. The modules can be easily used within Python scripts after they are compiled, or you can use automatic compilation which is described later in installition section.
</p>

<h2>Requirements</h2>

<br>

<p>
<ul>
<li>Python 2.7</li>
<li>Cython (<a href="http://cython.org/" title="http://cython.org/" class="http">http://cython.org/</a>)</li>
<li>NumPy</li>
</ul>
</p>

<h2>Installation</h2>

<br>

<p>
Put this directory containing the Python and Cython (.pyx) modules to your <tt>PYTHONPATH</tt> environment variable. You can either run the setup scripts in the directory as
</p>

<p>
<tt>python setup_x.py build_ext --inplace</tt>
</p>

<p>
<b>or</b> you can use automatic compilation of Cython modules by adding line
</p>

<p>
<tt>import pyximport; pyximport.install()</tt>
</p>

<p>
to your Python scripts using the Cython modules. See <a href="http://docs.cython.org/en/latest/src/tutorial/cython_tutorial.html" title="http://docs.cython.org/en/latest/src/tutorial/cython_tutorial.html" class="http">http://docs.cython.org/en/latest/src/tutorial/cython_tutorial.html</a> for more information.
</p>

<h2>Usage</h2>

<br>

<h3>cube_file_writer:</h3>

<p>
<ul>
<li><tt>write_cube_orthogonal</tt> can be used to write data on orthogonal grid to a cube file. <tt>xgrid</tt>, <tt>ygrid</tt> and <tt>zgrid</tt> define the grid points. <tt>grid_data</tt> is a NumPy array of shape <tt>(len(xgrid), len(ygrid), len(zgrid))</tt> containing the values on the grid.</li>
<li><tt>write_cube_nonorthogonal</tt> can be used to write data on non-orthogonal grid to a cube file. In this case, <tt>n_grid</tt> defines the number of grid points along each voxel vector/incremental cell vector, and <tt>voxel_vectors</tt> is a 3x3 array containing the voxel vectors. <tt>grid_data</tt> is a NumPy array of shape <tt>(n_grid[0], n_grid[1], n_grid[2])</tt> containing the values on the grid.</li>
<li><tt>write_to_cube_with_atoms</tt> is the same function as <tt>write_cube_orthogonal</tt> except in that it allows to write an atomic geometry to the cube file. If the number of atoms is n, <tt>atom_types</tt> is expected to be a NumPy array of shape <tt>(n, 1)</tt> containing the atomic numbers and <tt>atom_pos</tt> is an array of shape <tt>(n, 3)</tt> containing the positions of each atom.</li>
</ul>
</p>

<h3>cube_import:</h3>

<p>
<ul>
<li><tt>read_cube_nonorthogonal</tt> reads a cube file with non-orthogonal voxel vectors and returns the atomic geometry, voxel vectors and an array of shape <tt>(n_voxels[0], n_voxels[1], n_voxels[2])</tt> called <tt>grid_data</tt> containing the values on grid points defined by the vectors. If <tt>return_unstructured_data=True</tt>, it returns <tt>volume_data</tt> which is an array of shape <tt>(n_voxels[0]*n_voxels[1]*n_voxels[2], 4)</tt> and each row contains the position of the grid point and the value at that point.</li>
<li><tt>read_cube_orthogonal</tt> reads a cube file with orthogonal voxel vectors and returns <tt>xs</tt>, <tt>ys</tt> and <tt>zs</tt> which define the grid points and <tt>grid_data</tt> which is an array of shape <tt>(len(xs), len(ys), len(zs))</tt> containing the values on grid.</li>
</ul>
</p>

<h3>locpot_import:</h3>

<p>
<ul>
<li>Works for CHGCAR files as well because the file format is the same (only the values on grid have different meaning)</li>
<li><tt>check_grid_orthogonality</tt> can be used to check whether the voxel vectors/incremental cell vectors in the LOCPOT/CHGCAR file are orthogonal or not.</li>
<li><tt>read_locpot</tt> reads a LOCPOT/CHGCAR file and returns the atomic geometry, grid points and an array of values on the grid points. The structure of return values depends on <tt>orthogonal</tt> and <tt>return_unstructured_data</tt> arguments and follows the same scheme as in <tt>cube_import</tt></li>
</ul>
</p>

<h2>Examples</h2>

<br>

<p>
You can find usage examples in <a href="" title="DFT_grid_atomic_geo_post_proc" class="page">DFT_grid_atomic_geo_post_proc</a> package:<br>
<ul>
<li><tt>plot_epot_cube</tt></li>
<li><tt>plot_locpot_efield_z</tt></li>
<li><tt>nonorthogonal_to_orthogonal_cube</tt></li>
</ul>
</p>

<h2>Author</h2>

<p>
Juha Ritala (2016)<br>
<a href="mailto:jritala@gmail.com" title="jritala@gmail.com" class="mailto">jritala@gmail.com</a>
</p>


<!-- End wiki content -->

</body>

</html>
